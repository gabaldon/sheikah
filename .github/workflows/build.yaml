name: Build

on: pull_request

jobs:
  build:
    runs-on: ${{ matrix.os }}

    strategy: 
      matrix:
        os: [
          # FIXME: uncomment macos when vue3 upgrade is merged: 
          # https://github.com/witnet/sheikah/pull/1829
          # macos-latest, 
          ubuntu-latest, 
          windows-latest
        ]

    steps:
      - name: Check out Git repository
        uses: actions/checkout@v2

      - name: Install Node.js, NPM and Yarn
        uses: actions/setup-node@v2
        with:
          node-version: 16.14.0
      - name: Build Electron app
        shell: bash
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          SIGN: false
        run: |
          yarn install --network-timeout 1000000
          yarn electron:build --publish="never"

      - name: Upload artifact
        uses: actions/upload-artifact@v1.0.0
        with:
          # Artifact name
          name: ${{ matrix.os }}-artifact
          # Directory containing files to upload
          path: dist_electron